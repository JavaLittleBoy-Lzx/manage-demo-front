# é¢„çº¦ç®¡ç†é¡µé¢å­—æ®µæ–°å¢è¯´æ˜

## ä¿®æ”¹æ—¶é—´
2024-12-09

## ä¿®æ”¹æ–‡ä»¶
`src/views/admin/Appointment.vue`

---

## æ–°å¢å­—æ®µè¯´æ˜

### 1. å®¡æ ¸çŠ¶æ€åˆ—
- **å­—æ®µå**ï¼šå®¡æ ¸çŠ¶æ€
- **å®½åº¦**ï¼š120px
- **ä½ç½®**ï¼šé¢„çº¦è¯¦æƒ…åˆ—ä¹‹å
- **æ˜¾ç¤ºå†…å®¹**ï¼šå¾…å®¡æ‰¹/å·²é€šè¿‡/æœªé€šè¿‡
- **æ˜¾ç¤ºæ ·å¼**ï¼šTagæ ‡ç­¾ï¼Œå¸¦é¢œè‰²åŒºåˆ†
  - å¾…å®¡æ‰¹ï¼šwarningï¼ˆæ©™è‰²ï¼‰
  - å·²é€šè¿‡ï¼šsuccessï¼ˆç»¿è‰²ï¼‰
  - æœªé€šè¿‡ï¼šdangerï¼ˆçº¢è‰²ï¼‰

### 2. å®¡æ‰¹äººåˆ—
- **å­—æ®µå**ï¼šå®¡æ‰¹äºº
- **å®½åº¦**ï¼š100px
- **æ•°æ®æº**ï¼š`auditusername` å­—æ®µ
- **æ˜¾ç¤ºå†…å®¹**ï¼šå®¡æ‰¹äººå§“åï¼Œæ— æ•°æ®æ˜¾ç¤º"-"
- **æ˜¾ç¤ºæ ·å¼**ï¼šç´«è‰²æ¸å˜èƒŒæ™¯ï¼Œå·¦ä¾§ç´«è‰²è¾¹æ¡†

### 3. å®¡æ‰¹æ—¶é—´åˆ—
- **å­—æ®µå**ï¼šå®¡æ‰¹æ—¶é—´
- **å®½åº¦**ï¼š160px
- **æ•°æ®æº**ï¼š`auditdate` å­—æ®µ
- **æ˜¾ç¤ºå†…å®¹**ï¼šå®¡æ‰¹æ—¶é—´ï¼Œæ— æ•°æ®æ˜¾ç¤º"-"
- **æ˜¾ç¤ºæ ·å¼**ï¼šæµ…ç´«è‰²èƒŒæ™¯ï¼Œåœ†è§’

### 4. è½¦è¾†çŠ¶æ€åˆ—
- **å­—æ®µå**ï¼šè½¦è¾†çŠ¶æ€
- **å®½åº¦**ï¼š200px
- **æ˜¾ç¤ºå†…å®¹**ï¼šåŒ…å«3ä¸ªçŠ¶æ€æ ‡ç­¾
  - âœ… **é¢„çº¦çŠ¶æ€**ï¼šå·²è¿‡æœŸ/æœ‰æ•ˆ
  - ğŸš— **å…¥åœºçŠ¶æ€**ï¼šå·²å…¥åœº/æœªå…¥åœº
  - ğŸšª **ç¦»åœºçŠ¶æ€**ï¼šå·²ç¦»åœº/æœªç¦»åœº
- **æ˜¾ç¤ºæ ·å¼**ï¼šçºµå‘æ’åˆ—çš„Tagæ ‡ç­¾
  - å·²è¿‡æœŸï¼šdangerï¼ˆçº¢è‰²ï¼‰
  - æœ‰æ•ˆï¼šsuccessï¼ˆç»¿è‰²ï¼‰
  - å·²å…¥åœºï¼šsuccessï¼ˆç»¿è‰²ï¼‰
  - æœªå…¥åœºï¼šinfoï¼ˆç°è‰²ï¼‰
  - å·²ç¦»åœºï¼šwarningï¼ˆæ©™è‰²ï¼‰
  - æœªç¦»åœºï¼šinfoï¼ˆç°è‰²ï¼‰

### 5. åœè½¦æ—¶é•¿åˆ—
- **å­—æ®µå**ï¼šåœè½¦æ—¶é•¿
- **å®½åº¦**ï¼š120px
- **æ˜¾ç¤ºå†…å®¹**ï¼šåœè½¦æ—¶é•¿ï¼ˆå¦‚"2å°æ—¶30åˆ†é’Ÿ"ï¼‰ï¼Œæ— æ•°æ®æ˜¾ç¤º"-"
- **è®¡ç®—é€»è¾‘**ï¼šå…¥åœºæ—¶é—´åˆ°ç¦»åœºæ—¶é—´çš„æ—¶é—´å·®
- **æ˜¾ç¤ºæ ·å¼**ï¼šæ©™è‰²æ¸å˜èƒŒæ™¯ï¼Œå·¦ä¾§æ©™è‰²è¾¹æ¡†

---

## æ•°æ®å¤„ç†é€»è¾‘

### 1. åˆ¤æ–­æ˜¯å¦è¿‡æœŸ `checkIfExpired`
```javascript
// æ¯”è¾ƒé¢„çº¦æ—¥æœŸå’Œå½“å‰æ—¥æœŸ
// é¢„çº¦æ—¥æœŸ < ä»Šå¤© = å·²è¿‡æœŸ
const checkIfExpired = (visitdate) => {
    if (!visitdate) return false;
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    const visitDate = new Date(visitdate);
    visitDate.setHours(0, 0, 0, 0);
    return visitDate < today;
};
```

### 2. åˆ¤æ–­æ˜¯å¦å…¥åœº `checkIfEntered`
```javascript
// æ£€æŸ¥å…¥åœºæ—¶é—´å­—æ®µæ˜¯å¦å­˜åœ¨
// æ”¯æŒå¤šç§å­—æ®µåï¼šentertimeã€entrytimeã€enter_time
const checkIfEntered = (item) => {
    return !!(item.entertime || item.entrytime || item.enter_time);
};
```

### 3. åˆ¤æ–­æ˜¯å¦ç¦»åœº `checkIfLeft`
```javascript
// æ£€æŸ¥ç¦»åœºæ—¶é—´å­—æ®µæ˜¯å¦å­˜åœ¨
// æ”¯æŒå¤šç§å­—æ®µåï¼šleavetimeã€leave_time
const checkIfLeft = (item) => {
    return !!(item.leavetime || item.leave_time);
};
```

### 4. è®¡ç®—åœè½¦æ—¶é•¿ `calculateParkingDuration`
```javascript
// è®¡ç®—å…¥åœºæ—¶é—´åˆ°ç¦»åœºæ—¶é—´çš„æ—¶é—´å·®
// è¿”å›æ ¼å¼ï¼š
//   - è¶…è¿‡1å°æ—¶ï¼š"{å°æ—¶}å°æ—¶{åˆ†é’Ÿ}åˆ†é’Ÿ"
//   - ä¸è¶³1å°æ—¶ï¼š"{åˆ†é’Ÿ}åˆ†é’Ÿ"
const calculateParkingDuration = (item) => {
    const enterTime = item.entertime || item.entrytime || item.enter_time;
    const leaveTime = item.leavetime || item.leave_time;
    
    if (!enterTime || !leaveTime) return null;
    
    const enter = new Date(enterTime);
    const leave = new Date(leaveTime);
    const diffMs = leave - enter;
    
    if (diffMs < 0) return null;
    
    const diffMinutes = Math.floor(diffMs / (1000 * 60));
    const hours = Math.floor(diffMinutes / 60);
    const minutes = diffMinutes % 60;
    
    if (hours > 0) {
        return `${hours}å°æ—¶${minutes}åˆ†é’Ÿ`;
    } else {
        return `${minutes}åˆ†é’Ÿ`;
    }
};
```

---

## è¯¦æƒ…å¼¹çª—å¢å¼º

åœ¨æŸ¥çœ‹è¯¦æƒ…å¼¹çª—ä¸­æ–°å¢"è½¦è¾†çŠ¶æ€"éƒ¨åˆ†ï¼š
- é¢„çº¦çŠ¶æ€ï¼ˆæœ‰æ•ˆ/å·²è¿‡æœŸï¼‰
- å…¥åœºçŠ¶æ€ï¼ˆå·²å…¥åœº/æœªå…¥åœºï¼‰
- ç¦»åœºçŠ¶æ€ï¼ˆå·²ç¦»åœº/æœªç¦»åœºï¼‰
- åœè½¦æ—¶é•¿ï¼ˆå¦‚æœæœ‰æ•°æ®ï¼‰

---

## è¡¨æ ¼åˆ—é¡ºåº

ä¿®æ”¹åçš„åˆ—é¡ºåºï¼š
1. é¢„çº¦ä¿¡æ¯ï¼ˆè½¦ç‰Œå·ã€é¢„çº¦æ—¥æœŸï¼‰
2. ä¸šä¸»ä¿¡æ¯ï¼ˆä¸šä¸»å§“åã€ç”µè¯ã€è®¿å®¢ç”µè¯ï¼‰
3. åœ°å€ä¿¡æ¯ï¼ˆçœå¸‚åŒºã€å°åŒºã€æ¥¼æ ‹å•å…ƒï¼‰
4. é¢„çº¦è¯¦æƒ…ï¼ˆæ¥è®¿ç›®çš„ã€é¢„çº¦ç±»å‹ï¼‰
5. **å®¡æ ¸çŠ¶æ€** â­ æ–°å¢
6. **å®¡æ‰¹äºº** â­ æ–°å¢
7. **å®¡æ‰¹æ—¶é—´** â­ æ–°å¢
8. **è½¦è¾†çŠ¶æ€** â­ æ–°å¢ï¼ˆåŒ…å«3ä¸ªå­çŠ¶æ€ï¼‰
9. **åœè½¦æ—¶é•¿** â­ æ–°å¢
10. æ“ä½œï¼ˆè¯¦æƒ…æŒ‰é’®ï¼‰

---

## æ ·å¼è¯´æ˜

### å®¡æ‰¹äººæ ·å¼ `.auditor-cell`
```scss
.auditor-name {
    font-size: 13px;
    font-weight: 600;
    color: #2d3748;
    padding: 4px 8px;
    background: linear-gradient(135deg, #f3e8ff 0%, #faf5ff 100%);
    border-radius: 6px;
    border-left: 2px solid #8b5cf6;
}
```

### å®¡æ‰¹æ—¶é—´æ ·å¼ `.audit-time-cell`
```scss
.audit-time {
    font-size: 12px;
    color: #4a5568;
    padding: 4px 8px;
    background: rgba(139, 92, 246, 0.1);
    border-radius: 4px;
    white-space: nowrap;
}
```

### è½¦è¾†çŠ¶æ€æ ·å¼ `.vehicle-status-cell`
```scss
// çºµå‘å¸ƒå±€ï¼Œæ¯ä¸ªçŠ¶æ€æ ‡ç­¾ç‹¬ç«‹ä¸€è¡Œ
display: flex;
flex-direction: column;
gap: 4px;

.el-tag {
    font-size: 11px;
    padding: 3px 8px;
    border-radius: 4px;
    font-weight: 500;
    min-width: 60px;
    text-align: center;
}
```

### åœè½¦æ—¶é•¿æ ·å¼ `.parking-duration-cell`
```scss
.duration-value {
    font-size: 13px;
    font-weight: 600;
    color: #2d3748;
    padding: 6px 10px;
    background: linear-gradient(135deg, #fef3e2 0%, #fef7ed 100%);
    border-radius: 6px;
    border-left: 2px solid #f59e0b;
    white-space: nowrap;
}
```

---

## æ•°æ®å…¼å®¹æ€§è¯´æ˜

ä¸ºä¿è¯æœ€å¤§å…¼å®¹æ€§ï¼Œå…¥åœºå’Œç¦»åœºæ—¶é—´å­—æ®µæ”¯æŒå¤šç§å‘½åæ–¹å¼ï¼š

**å…¥åœºæ—¶é—´å­—æ®µ**ï¼š
- `entertime`
- `entrytime`
- `enter_time`

**ç¦»åœºæ—¶é—´å­—æ®µ**ï¼š
- `leavetime`
- `leave_time`

ç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•è¿™äº›å­—æ®µåï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰æ•ˆå€¼å³å¯ã€‚

---

## æµ‹è¯•å»ºè®®

1. âœ… æµ‹è¯•ä¸åŒçŠ¶æ€çš„é¢„çº¦è®°å½•æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®
2. âœ… æµ‹è¯•å·²è¿‡æœŸé¢„çº¦çš„æ˜¾ç¤ºï¼ˆçº¢è‰²æ ‡ç­¾ï¼‰
3. âœ… æµ‹è¯•å·²å…¥åœºæœªç¦»åœºçš„è®°å½•
4. âœ… æµ‹è¯•å®Œæ•´æµç¨‹ï¼ˆå…¥åœº+ç¦»åœºï¼‰çš„åœè½¦æ—¶é•¿è®¡ç®—
5. âœ… æµ‹è¯•æ— å®¡æ‰¹äºº/å®¡æ‰¹æ—¶é—´çš„è®°å½•æ˜¾ç¤º
6. âœ… æµ‹è¯•è¯¦æƒ…å¼¹çª—ä¸­æ–°å¢çš„è½¦è¾†çŠ¶æ€éƒ¨åˆ†

---

## æ³¨æ„äº‹é¡¹

1. **åœè½¦æ—¶é•¿ä»…åœ¨åŒæ—¶æœ‰å…¥åœºå’Œç¦»åœºæ—¶é—´æ—¶è®¡ç®—**
2. **å®¡æ‰¹äººå’Œå®¡æ‰¹æ—¶é—´æ— æ•°æ®æ—¶æ˜¾ç¤º"-"**
3. **è¿‡æœŸåˆ¤æ–­åŸºäºé¢„çº¦æ—¥æœŸï¼Œä¸è€ƒè™‘å…·ä½“æ—¶é—´**
4. **çŠ¶æ€æ ‡ç­¾ä½¿ç”¨ä¸åŒé¢œè‰²ä¾¿äºå¿«é€Ÿè¯†åˆ«**
5. **è¡¨æ ¼å®½åº¦å¢åŠ ï¼Œå»ºè®®ä½¿ç”¨è¾ƒå¤§å±å¹•æˆ–æ¨ªå‘æ»šåŠ¨æŸ¥çœ‹**

---

**ä¿®æ”¹å®Œæˆï¼** ğŸ‰
